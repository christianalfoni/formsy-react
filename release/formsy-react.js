!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.Formsy=e(require("react")):t.Formsy=e(t.React)}(this,function(t){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var i=function(t){return t&&t.__esModule?t:{"default":t}},n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.__esModule=!0;var u=r(4),s=i(u),o=r(3),a=i(o),l=r(1),F=i(l),d=r(2),p=i(d),c={};c.Mixin=p["default"],c.addValidationRule=function(t,e){a["default"][t]=e},c.Form=s["default"].createClass({displayName:"Form",getInitialState:function(){return{isValid:!0,isSubmitting:!1,canChange:!1}},getDefaultProps:function(){return{onSuccess:function(){},onError:function(){},onSubmit:function(){},onValidSubmit:function(){},onInvalidSubmit:function(){},onSubmitted:function(){},onValid:function(){},onInvalid:function(){},onChange:function(){},validationErrors:null,preventExternalInvalidation:!1}},componentWillMount:function(){this.inputs={},this.model={}},componentDidMount:function(){this.validateForm()},componentWillUpdate:function(){this.prevInputKeys=Object.keys(this.inputs)},componentDidUpdate:function(){this.props.validationErrors&&this.setInputValidationErrors(this.props.validationErrors);var t=Object.keys(this.inputs);F["default"].arraysDiffer(this.prevInputKeys,t)&&this.validateForm()},reset:function(t){this.setFormPristine(!0),this.resetModel(t)},submit:function(t){t&&t.preventDefault(),this.setFormPristine(!1),this.updateModel();var e=this.mapModel();this.props.onSubmit(e,this.resetModel,this.updateInputsWithError),this.state.isValid?this.props.onValidSubmit(e,this.resetModel,this.updateInputsWithError):this.props.onInvalidSubmit(e,this.resetModel,this.updateInputsWithError)},mapModel:function(){var t=this;return this.props.mapping?this.props.mapping(this.model):Object.keys(this.model).reduce(function(e,r){for(var i=r.split("."),n=e;i.length;){var u=i.shift();n=n[u]=i.length?n[u]||{}:t.model[r]}return e},{})},updateModel:function(){var t=this;Object.keys(this.inputs).forEach(function(e){var r=t.inputs[e];t.model[e]=r.state._value})},resetModel:function(t){var e=this;Object.keys(this.inputs).forEach(function(r){t&&t[r]?e.inputs[r].setValue(t[r]):e.inputs[r].resetValue()}),this.validateForm()},setInputValidationErrors:function(t){var e=this;Object.keys(this.inputs).forEach(function(r){var i=e.inputs[r],n=[{_isValid:!(r in t),_validationError:t[r]}];i.setState.apply(i,n)})},isChanged:function(){return!F["default"].isSame(this.getPristineValues(),this.getCurrentValues())},getPristineValues:function(){var t=this.inputs;return Object.keys(t).reduce(function(e,r){var i=t[r];return e[r]=i.props.value,e},{})},updateInputsWithError:function(t){var e=this;Object.keys(t).forEach(function(r){var i=e.inputs[r];if(!i)throw new Error("You are trying to update an input that does not exist. Verify errors object with input names. "+JSON.stringify(t));var n=[{_isValid:e.props.preventExternalInvalidation||!1,_externalError:t[r]}];i.setState.apply(i,n)})},traverseChildrenAndRegisterInputs:function(t){var e=this;return"object"!=typeof t||null===t?t:s["default"].Children.map(t,function(t){return"object"!=typeof t||null===t?t:t.props&&t.props.name?s["default"].cloneElement(t,{_attachToForm:e.attachToForm,_detachFromForm:e.detachFromForm,_validate:e.validate,_isFormDisabled:e.isFormDisabled,_isValidValue:function(t,r){return e.runValidation(t,r).isValid}},t.props&&t.props.children):s["default"].cloneElement(t,{},e.traverseChildrenAndRegisterInputs(t.props&&t.props.children))},this)},isFormDisabled:function(){return this.props.disabled},getCurrentValues:function(){var t=this;return Object.keys(this.inputs).reduce(function(e,r){var i=t.inputs[r];return e[r]=i.state._value,e},{})},setFormPristine:function(t){var e=this.inputs,r=Object.keys(e);this.setState({_formSubmitted:!t}),r.forEach(function(r){var i=e[r];i.setState({_formSubmitted:!t,_isPristine:t})})},validate:function(t){this.state.canChange&&this.props.onChange(this.getCurrentValues(),this.isChanged());var e=this.runValidation(t);t.setState({_isValid:e.isValid,_isRequired:e.isRequired,_validationError:e.error,_externalError:null},this.validateForm)},runValidation:function(t,e){var r=this.getCurrentValues(),i=t.props.validationErrors,n=t.props.validationError;e=2===arguments.length?e:t.state._value;var u=this.runRules(e,r,t._validations),s=this.runRules(e,r,t._requiredValidations);"function"==typeof t.validate&&(u.failed=t.validate()?[]:["failed"]);var o=Object.keys(t._requiredValidations).length?!!s.success.length:!1,a=!(u.failed.length||this.props.validationErrors&&this.props.validationErrors[t.props.name]);return{isRequired:o,isValid:o?!1:a,error:function(){return a&&!o?"":u.errors.length?u.errors[0]:this.props.validationErrors&&this.props.validationErrors[t.props.name]?this.props.validationErrors[t.props.name]:o?i[s.success[0]]||null:a?void 0:i[u.failed[0]]||n}.call(this)}},runRules:function(t,e,r){var i={errors:[],failed:[],success:[]};return Object.keys(r).forEach(function(n){if("function"==typeof r[n]){if(a["default"][n])throw new Error("Formsy does not allow you to override default validations: "+n);var u=r[n](e,t);return void("string"==typeof u?(i.errors.push(u),i.failed.push(n)):u||i.failed.push(n))}if("function"!=typeof r[n]){if(!a["default"][n])throw new Error("Formsy does not have the validation rule: "+n);var u=a["default"][n](e,t,r[n]);return void("string"==typeof u?(i.errors.push(u),i.failed.push(n)):u?i.success.push(n):i.failed.push(n))}i.success.push(n)}),i},validateForm:function(){var t=this,e=!0,r=this.inputs,i=Object.keys(r),n=function(){e=i.every(function(t){return r[t].state._isValid}),t.setState({isValid:e}),e?t.props.onValid():t.props.onInvalid(),t.setState({canChange:!0})};i.forEach(function(e,u){var s=r[e],o=t.runValidation(s);o.isValid&&s.state._externalError&&(o.isValid=!1),s.setState({_isValid:o.isValid,_isRequired:o.isRequired,_validationError:o.error,_externalError:!o.isValid&&s.state._externalError?s.state._externalError:null},u===i.length-1?n:null)}),!i.length&&this.isMounted()&&this.setState({canChange:!0})},attachToForm:function(t){this.inputs[t.props.name]=t,this.model[t.props.name]=t.state._value,this.validate(t)},detachFromForm:function(t){delete this.inputs[t.props.name],delete this.model[t.props.name]},render:function(){return s["default"].createElement("form",n({},this.props,{onSubmit:this.submit}),this.traverseChildrenAndRegisterInputs(this.props.children))}}),e["default"]=c,t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]={arraysDiffer:function(t,e){var r=this;return t.length!==e.length?!0:t.some(function(t,i){return!r.isSame(t,e[i])})},objectsDiffer:function(t,e){var r=this;return Object.keys(t).length!==Object.keys(e).length?!0:Object.keys(t).some(function(i){return!r.isSame(t[i],e[i])})},isSame:function(t,e){return typeof t!=typeof e?!1:Array.isArray(t)?!this.arraysDiffer(t,e):"object"==typeof t&&null!==t&&null!==e?!this.objectsDiffer(t,e):t===e}},t.exports=e["default"]},function(t,e,r){"use strict";var i=function(t){return t&&t.__esModule?t:{"default":t}};e.__esModule=!0;var n=r(1),u=i(n),s=function(t){return"string"!=typeof t?t||{}:t.split(/\,(?![^{\[]*[}\]])/g).reduce(function(t,e){var r=e.split(":"),i=r.shift();if(r=r.map(function(t){try{return JSON.parse(t)}catch(e){return t}}),r.length>1)throw new Error("Formsy does not support multiple args on string validations. Use object format of validations instead.");return t[i]=r.length?r[0]:!0,t},{})};e["default"]={getInitialState:function(){return{_value:this.props.value,_isRequired:!1,_isValid:!0,_isPristine:!0,_pristineValue:this.props.value,_validationError:"",_externalError:null,_formSubmitted:!1}},getDefaultProps:function(){return{validationError:"",validationErrors:{}}},componentWillMount:function(){var t=this,e=function(){t.setValidations(t.props.validations,t.props.required),t.props._attachToForm(t)};if(!this.props.name)throw new Error("Form Input requires a name property when used");return this.props._attachToForm?void e():setTimeout(function(){if(t.isMounted()){if(!t.props._attachToForm)throw new Error("Form Mixin requires component to be nested in a Form");e()}},0)},componentWillReceiveProps:function(t){this.setValidations(t.validations,t.required)},componentDidUpdate:function(t){u["default"].isSame(this.props.value,t.value)||this.setValue(this.props.value)},componentWillUnmount:function(){this.props._detachFromForm(this)},setValidations:function(t,e){this._validations=s(t),this._requiredValidations=e===!0?{isDefaultRequiredValue:!0}:s(e)},setValue:function(t){var e=this;this.setState({_value:t,_isPristine:!1},function(){return e.props._validate(e)})},resetValue:function(){var t=this;this.setState({_value:this.state._pristineValue,_isPristine:!0},function(){return t.props._validate(t)})},getValue:function(){return this.state._value},hasValue:function(){return""!==this.state._value},getErrorMessage:function(){return!this.isValid()||this.showRequired()?this.state._externalError||this.state._validationError:null},isFormDisabled:function(){return this.props._isFormDisabled()},isValid:function(){return this.state._isValid},isPristine:function(){return this.state._isPristine},isFormSubmitted:function(){return this.state._formSubmitted},isRequired:function(){return!!this.props.required},showRequired:function(){return this.state._isRequired},showError:function(){return!this.showRequired()&&!this.isValid()},isValidValue:function(t){return this.props._isValidValue.call(null,this,t)}},t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0;var r=function(t){return null!==t&&void 0!==t},i=function(t){return""===t},n={isDefaultRequiredValue:function(t,e){return void 0===e||""===e},isExisty:function(t){function e(e,r){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){return r(e)}),matchRegexp:function(t,e,n){return!r(e)||i(e)||n.test(e)},isUndefined:function(t,e){return void 0===e},isEmptyString:function(t,e){return i(e)},isEmail:function(t,e){return n.matchRegexp(t,e,/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i)},isUrl:function(t,e){return n.matchRegexp(t,e,/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i)},isTrue:function(t,e){return e===!0},isFalse:function(t,e){return e===!1},isNumeric:function(t,e){return"number"==typeof e?!0:n.matchRegexp(t,e,/^[-+]?(\d*[.])?\d+$/)},isAlpha:function(t,e){return n.matchRegexp(t,e,/^[a-zA-Z]+$/)},isWords:function(t,e){return n.matchRegexp(t,e,/^[a-zA-Z\s]+$/)},isSpecialWords:function(t,e){return n.matchRegexp(t,e,/^[a-zA-Z\s\u00C0-\u017F]+$/)},isLength:function(t,e,n){return!r(e)||i(e)||e.length===n},equals:function(t,e,n){return!r(e)||i(e)||e==n},equalsField:function(t,e,r){return e==t[r]},maxLength:function(t,e,i){return!r(e)||e.length<=i},minLength:function(t,e,n){return!r(e)||i(e)||e.length>=n}};e["default"]=n,t.exports=e["default"]},function(e,r){e.exports=t}])});
//# sourceMappingURL=formsy-react.js.map